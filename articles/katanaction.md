---
title: "kintoneã§åå¿œé€Ÿåº¦ã‚²ãƒ¼ãƒ ã‚’ä½œã£ã¦ã¿ãŸ"
emoji: "âš”"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["kintone"]
published: true
---

## ã¯ã˜ã‚ã«

ã‚µã‚¤ãƒœã‚¦ã‚ºãŒæä¾›ã™ã‚‹ã‚¯ãƒ©ã‚¦ãƒ‰ã‚µãƒ¼ãƒ“ã‚¹ [kintone](https://kintone.cybozu.co.jp/) ã¯æ¥­å‹™ã‚·ã‚¹ãƒ†ãƒ ãŒä½œæˆã§ãã‚‹ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã§ã™ã€‚æœ¬æ¥ã¯ä»•äº‹ã§ä½¿ã†ãƒ„ãƒ¼ãƒ«ã¨ã—ã¦ã€

- æ¡ˆä»¶ç®¡ç†
- é¡§å®¢ç®¡ç†
- æ—¥å ±
- ã‚¿ã‚¹ã‚¯ç®¡ç†

ç­‰ã«ä½¿ã‚ã‚Œã‚‹ã‚±ãƒ¼ã‚¹ãŒã»ã¨ã‚“ã©ã§ã™ãŒã€ä»Šå›ã¯ãã‚“ãªçœŸé¢ç›®ãªä½¿ã„æ–¹ã§ã¯ãªãã€kintoneã‚’ **ã‚²ãƒ¼ãƒ ** ã¨ã—ã¦ä½¿ã£ã¦ã¿ãŸè¨˜äº‹ã§ã™ã€‚

**~~ä¸çœŸé¢ç›®~~ ãƒã‚¿**è¨˜äº‹ã¨ã—ã¦ãŠæ¥½ã—ã¿ãã ã•ã„ğŸ˜

## ä½œã£ãŸã‚‚ã®

- ãƒ—ãƒ¬ã‚¤å‹•ç”»

https://twitter.com/BB_File/status/1369249452238671876

- ã‚¤ãƒ¡ãƒ¼ã‚¸å†™çœŸ

![](https://storage.googleapis.com/zenn-user-upload/luptbqr2t4v06sabcg1yyme1ptkz)

ãã®åã‚‚ **KATANACTION!!** ã‚«ã‚¿ãƒŠã§ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã™ã‚‹ã‚²ãƒ¼ãƒ ã§ã™âš”

## ä½¿ã£ãŸã‚‚ã®

- ã‚«ã‚¿ãƒŠã®ãŠã‚‚ã¡ã‚ƒ Ã— 2æœ¬
- obniz(M5StickCç‰ˆ) Ã— 2ã¤
- obniz(ãƒ–ãƒ­ãƒƒã‚¯å€’ã™ç”¨) Ã— 1ã¤
- ç£æ°—ã‚»ãƒ³ã‚µ Ã— 2ã¤
- ç£çŸ³ Ã— 2ã¤
- ç™ºæ³¡ãƒ–ãƒ­ãƒƒã‚¯ Ã— 6ã¤
- ã‚µãƒ¼ãƒœãƒ¢ãƒ¼ã‚¿ Ã— 2ã¤


ç·é¡15,000å††ãã‚‰ã„ã€‚
**ã‚«ã‚¿ãƒŠã®ãŠã‚‚ã¡ã‚ƒ** ã¯ãƒ€ã‚¤ã‚½ãƒ¼ã§å£²ã£ã¦ã„ãŸã‚‚ã®ã‚’åˆ†è§£ã—ã¦ä¸­ã«obnizã‚’åŸ‹ã‚è¾¼ã‚“ã§ã„ã¾ã™ã€‚
åˆ€èº«ã«ç£æ°—ã‚»ãƒ³ã‚µã‚’åŸ‹ã‚è¾¼ã¿ã€é˜å´ã«ç£çŸ³ã‚’ä»˜ã‘ã¦ã„ã¾ã™ã€‚

![](https://docs.google.com/drawings/d/e/2PACX-1vTW0Eq7prW8aQGu1yztvEhT2Yej3UtTKsSPuYZLxb0Rgu_8rai4dejxcUBIrY9WFZfeqRMq4uUa8WV7/pub?w=768&amp;h=401)

**å€’ã‚Œã‚‹ç‰©ä½“** ã¯ç™ºæ³¡ãƒ–ãƒ­ãƒƒã‚¯ã‚’é‡ã­ã¦ã„ã¦ã€ä¸‹ã®æ®µã«ã‚µãƒ¼ãƒœãƒ¢ãƒ¼ã‚¿ã‚’åŸ‹ã‚è¾¼ã‚“ã§ã„ã¾ã™ã€‚
æœ€åˆã‚½ãƒ¬ãƒã‚¤ãƒ‰ã‚’ä½¿ã£ã¦æŠ¼ã—ä¸Šã’ã‚‹æ–¹æ³•ã§ã‚„ã‚ã†ã¨ã—ã¾ã—ãŸãŒã€ãƒ‘ãƒ¯ãƒ¼ãŒè¶³ã‚Šãšãƒ¢ãƒ¼ã‚¿ã§ã€‚
![](https://docs.google.com/drawings/d/e/2PACX-1vTsZRliueevJOwUu-ToTQjzVvLFIqGOia0arbjKlr-17b5_G3Mox1LmTfpkO-oEmNHDAtskT8WDrYdo/pub?w=926&amp;h=520)

ã‚ã‚Šã¨ã¡ã‚ƒã‚“ã¨å‹•ãï¼
https://twitter.com/BB_File/status/1369249780715511811

## ã‚·ã‚¹ãƒ†ãƒ æ§‹æˆå›³

kintoneã®ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚ºãƒ“ãƒ¥ãƒ¼ï¼ˆHTMLãŒè‡ªç”±ã«åŸ‹ã‚è¾¼ã‚ã‚‹å ´æ‰€ï¼‰ã«Vue.jsã§ä½œæˆã—ãŸã‚²ãƒ¼ãƒ ç”»é¢ã‚’åŸ‹ã‚è¾¼ã‚“ã§ã„ã¾ã™ã€‚obnizã‚’å‹•ã‹ã™JavaScriptãƒ—ãƒ­ã‚°ãƒ©ãƒ ã¯kintoneä¸Šã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã¦ã„ã¾ã™ã€‚
![](https://docs.google.com/drawings/d/e/2PACX-1vTGb01hm8MTj64WQRhECcc7W6P4Wm9LEi12kMoGmofh9s7SH9WI3P8HgStal-BYPjED4XBcU57DssMa/pub?w=927&amp;h=603)

## ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰

å…¨éƒ¨è¼‰ã›ã‚‹ã¨è†¨å¤§ã«ãªã‚‹ã®ã§ä¸€éƒ¨ã®ã¿æŠœç²‹ã—ã¾ã™ã€‚

### ã‚«ã‚¿ãƒŠ

ç£æ°—ã‚»ãƒ³ã‚µã¯ãƒœã‚¿ãƒ³ã¨åŒã˜æ‰±ã„ãªã®ã§ã€[obnizã®ãƒœã‚¿ãƒ³æ“ä½œã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ](https://obniz.com/ja/sdk/parts/Button/README.md)ãŒä½¿ãˆã¾ã™ã€‚

```javascript:katana_sample.js
const katana1 = new Obniz.M5StickC('XXXX-XXXX'); // M5StickCç”¨ã®ãƒ¡ã‚½ãƒƒãƒ‰
let count1 = 0;

katana1.onconnect = async function() {
  const sensor1 = katana1.wired('Button', {signal: 26, pull: '3v'});
  sensor1.onchange = async state => {
    if (!state) {
      count1++;
      // ã‚«ã‚¦ãƒ³ãƒˆæ•°ã«å¿œã˜ã¦ã‚µãƒ¼ãƒœãƒ¢ãƒ¼ã‚¿ã‚’å‹•ã‹ã™å‡¦ç†ã‚’è¿½è¨˜
    }
  };
};
```

é˜ã«ç£çŸ³ã‚’ã¤ã‘ã‚‹ã“ã¨ã§ã€Œé˜ã‚’æŠœãå·®ã—ã™ã‚‹ã¨ç£æ°—ã‚»ãƒ³ã‚µãŒåå¿œã—ã¦ã‚«ã‚¦ãƒ³ãƒˆã‚¢ãƒƒãƒ—ã€ã•ã‚Œã¦ã„ãã¾ã™ã€‚ã‚ã¨ã¯ã‚«ã‚¦ãƒ³ãƒˆæ•°ã«å¿œã˜ã¦å‡¦ç†ã‚’è¿½è¨˜ã™ã‚‹ã ã‘ã§ã™ã€‚

## å€’ã‚Œã‚‹ç‰©ä½“

[obnizã®ã‚µãƒ¼ãƒœãƒ¢ãƒ¼ã‚¿ã‚’æ“ä½œã™ã‚‹ãƒ—ãƒ­ã‚°ãƒ©ãƒ ](https://obniz.com/ja/sdk/parts/ServoMotor/README.md)ãŒãã®ã¾ã¾ä½¿ãˆã¾ã™ã€‚

```javascript:servo_sample.js
const block = new Obniz('XXXX-XXXX');

block.onconnect = async function() {
  servo1 = block.wired('ServoMotor', {gnd:0, vcc:1, signal:2});
  servo2 = block.wired('ServoMotor', {gnd:3, vcc:4, signal:5});
  servo1.angle(0);
  servo2.angle(0);

  // ã‚«ã‚¿ãƒŠã®å‡¦ç†ã‚’çµ„ã¿åˆã‚ã›ã¦ servo?.angle(90)ã«ã™ã‚‹
};
```

## ã‚«ã‚¿ãƒŠã¨å€’ã‚Œã‚‹ç‰©ä½“ã®ã‚³ãƒ¼ãƒ‰ã‚’åˆä½“

```javascript:sample.js
const katana1 = new Obniz.M5StickC('XXXX-XXXX'); // Player1ã®ã‚«ã‚¿ãƒŠç”¨
const katana2 = new Obniz.M5StickC('XXXX-XXXX'); // Player2ã®ã‚«ã‚¿ãƒŠç”¨
const block = new Obniz('XXXX-XXXX'); // å€’ã‚Œã‚‹ç‰©ä½“ç”¨

let count1 = 0;
let count2 = 0;
let sensor1, sensor2, servo1, servo2;

// obnizã®ã‚³ãƒã‚¯ã‚·ãƒ§ãƒ³
katana1.onconnect = () => {
  sensor1 = katana1.wired('Button', {signal: 26, pull: '3v'});
};
katana2.onconnect = () => {
  sensor2 = katana2.wired('Button', {signal: 26, pull: '3v'});
};
block.onconnect = () => {
  servo1 = obniz.wired("ServoMotor", {gnd: 0, vcc: 1, signal: 2});
  servo2 = obniz.wired("ServoMotor", {gnd: 3, vcc: 4, signal: 5});
};

// ã‚«ã‚¿ãƒŠ1ã‚’æŠœãå·®ã—ã—ãŸã¨ãã®ã‚¤ãƒ™ãƒ³ãƒˆ
sensor1.onchange = async state => {
  if (!state) {
    count1++;
    if (count1 === 1) {
      // Player1ãŒåå¿œã—ãŸ

      if (count2 < 1) {
        // count1ãŒ1ã®ã¨ãã«count2ãŒ1æœªæº€ãªã‚‰ã€Player1ãŒå…ˆã«å‹•ã‹ã—ãŸã“ã¨ã«ãªã‚‹
        // => Player1ã®å‹ã¡
        servo1.angle(90);
      }
    }
  }
};

// ã‚«ã‚¿ãƒŠ2ã‚’æŠœãå·®ã—ã—ãŸã¨ãã®ã‚¤ãƒ™ãƒ³ãƒˆ
sensor2.onchange = async state => {
  if (!state) {
    count2++;
    if (count2 === 1) {
      // Player2ãŒåå¿œã—ãŸ

      if (count1 < 1) {
        // count2ãŒ1ã®ã¨ãã«count1ãŒ1æœªæº€ãªã‚‰ã€Player2ãŒå…ˆã«å‹•ã‹ã—ãŸã“ã¨ã«ãªã‚‹
        // => Player2ã®å‹ã¡
        servo2.angle(90);
      }
    }
  }
};
```

## kintoneå´

kintoneå´ã¯ã‚ã‚Šã¨ç„¡é§„é£ã„ã‚’ã—ã¦ã„ã¦ã€

- ã‚²ãƒ¼ãƒ ç”»é¢ï¼šãŸã ã®HTMLç”»é¢ã¨ã—ã¦åˆ©ç”¨
- ãƒ©ãƒ³ã‚­ãƒ³ã‚°ç”»é¢ï¼šãŸã ã®HTMLç”»é¢ã¨ã—ã¦åˆ©ç”¨ï¼ˆè£å´ã§ãƒ©ãƒ³ã‚­ãƒ³ã‚°ãƒ‡ãƒ¼ã‚¿ã‚’kintoneã«æ ¼ç´ï¼‰

ã¨ã„ã£ãŸæ„Ÿã˜ã§ **ã€Œåˆ¥ã«kintoneã˜ã‚ƒãªãã¦ã‚‚è‰¯ãã­ï¼Ÿã€** æ„Ÿæº€è¼‰ã§ã™w

ãŸã ã€kintoneã‚’ãƒ•ãƒ­ãƒ³ãƒˆã«ã™ã‚‹ã“ã¨ã§ã€[kintone JavaScript API](https://developer.cybozu.io/hc/ja/articles/360000361686) ãŒä½¿ãˆã‚‹ã®ã§kintoneå†…ã®ãƒ‡ãƒ¼ã‚¿æ“ä½œã¯ã‚ã¡ã‚ƒãã¡ã‚ƒæ¥½ã§ã™ã€‚
ä»Šå›ã ã¨ã€ã‚µãƒ¼ãƒœãƒ¢ãƒ¼ã‚¿ã‚’ `servo?.angle(90)` ã«ã—ãŸå¾Œã€å„Playerã®åå¿œé€Ÿåº¦ã‚’kintoneã®DBã¸æ ¼ç´ã™ã‚‹ãŸã‚ã«kintone JavaScript APIã‚’ä½¿ã£ã¦ã„ã¾ã™ã€‚

```javascript:post_kintone_sample.js
const startTime = new Date().getTime();
let endTime1, endTime2;

// ã‚«ã‚¿ãƒŠ1ã‚’æŠœãå·®ã—ã—ãŸã¨ãã®ã‚¤ãƒ™ãƒ³ãƒˆ
sensor1.onchange = async state => {
  if (!state) {
    count1++;
    if (count1 === 1) {
      // Player1ãŒåå¿œã—ãŸ
      // ã‚¹ã‚¿ãƒ¼ãƒˆã—ã¦ã‹ã‚‰åå¿œã¾ã§ã®æ™‚é–“
      endTime1 = (new Date().getTime() - startTime) / 1000;

      if (count2 < 1) {
        // count1ãŒ1ã®ã¨ãã«count2ãŒ1æœªæº€ãªã‚‰ã€Player1ãŒå…ˆã«å‹•ã‹ã—ãŸã“ã¨ã«ãªã‚‹
        // => Player1ã®å‹ã¡
        servo1.angle(90);

        // kintoneã¸ãƒ‡ãƒ¼ã‚¿ã‚’ç™»éŒ²ã™ã‚‹å‡¦ç†
        const postParams = {
          app: 'XXX',
          record: {
            winner: { value: 'Player1' },
            player1_time: { value: endTime1 },
            player2_time: { value: endTime2 },
          }
        };
        await kintone.api(kintone.api.url('/k/v1/record'), 'POST', postParams);
      }
    }
  }
};
```

## ãŠã‚ã‚Šã«

kintoneã¯ãƒ“ã‚¸ãƒã‚¹ãƒ„ãƒ¼ãƒ«ã§ã™ãŒã€APIãŒæ­è¼‰ã•ã‚ŒãŸWeb DBãªã®ã§ãƒ“ã‚¸ãƒã‚¹ç”¨é€”ä»¥å¤–ã«ã‚‚ã„ã‚ã„ã‚ãªä½¿ã„æ–¹ãŒã§ãã¾ã™ã€‚ãœã²ã„ã‚ã„ã‚ãªã‚‚ã®ã«ä½¿ã£ã¦ã¿ã¦ãã ã•ã„ï¼
[ç„¡æ–™ã®é–‹ç™ºç’°å¢ƒ](https://developer.cybozu.io/hc/ja/articles/200720464)ã‚‚ã‚ã‚Šã¾ã™ã‚ˆã€œ
